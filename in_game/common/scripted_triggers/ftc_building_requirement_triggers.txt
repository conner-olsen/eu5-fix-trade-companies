# Can build/upgrade given TC building type in this location
# ROOT: location
# ARGS: building_type
ftc_company_building_location_potential = {
	ftc_is_in_trade_company_region = yes
	OR = {
		# No building is present
		NOT = {
			has_building = building_type:$building_type$
		}
		# Building is not max level and the queue isn't full
		AND = {
			any_buildings_in_location = {
				building_type = building_type:$building_type$
				owner = {
					is_subject = yes
				}
				is_max_level = no
			}
			any_buildings_in_location = {
				building_type = building_type:$building_type$
				owner = {
					is_subject_of = scope:actor
				}
				building_max_level > root.var:$building_type$_max_queue
			}
		}
	}
	# I have no idea why we need to surround this with a NOT,
	# but without it, the game checks if we DON'T have trade rights, so I added it
	NOT = {
		ftc_is_recieving_rights
	}
}

# Check if the owner of the location, or their overlord, is granting the actor tc rights
# ROOT: location
ftc_is_recieving_rights = {
	OR = {
		owner = {
			giving_scripted_relation = {
				type = relation_type:trade_company_rights
				target = scope:actor
			}
		}
		owner.top_overlord ?= {
			giving_scripted_relation = {
				type = relation_type:trade_company_rights
				target = scope:actor
			}
		}
	}
}

# Check if the region has a trade company established already.
# ROOT: location
ftc_is_in_trade_company_region = {
	scope:actor = {
		has_variable_list = trade_company_regions
		is_target_in_variable_list = {
			name = trade_company_regions
			target = root.region
		}
	}
}

# Meant to be false for the player. 
# Enabled for trade companies so that the AI can build still the 
# permanent buildings since they don't have the same pop issue.
# ROOT: country
ftc_hide_permanent_buildings_country_potential = {
	is_subject_type = trade_company
}
